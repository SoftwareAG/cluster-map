import * as tslib_1 from "tslib";
import { Component, forwardRef, Input, ViewChild } from '@angular/core';
import { get, cloneDeep } from 'lodash-es';
import { SchemaFormComponent } from '../forms/schema-form.component';
var FilteringFormComponent = /** @class */ (function () {
    function FilteringFormComponent() {
    }
    FilteringFormComponent.prototype.ngOnInit = function () {
        var column = this.context.property;
        this.schema = cloneDeep(column.filteringConfig.schema);
        this.form = cloneDeep(column.filteringConfig.form);
        this.model = cloneDeep(column.externalFilterQuery || {});
        this.options = { formDefaults: { ngModelOptions: { debounce: 100 } } };
    };
    FilteringFormComponent.prototype.canApply = function () {
        return get(this.schemaFormComponent, '$componentScope.vm.ngForm.$invalid');
    };
    FilteringFormComponent.prototype.applyFilter = function () {
        this.context.applyFilter({
            externalFilterQuery: this.model
        });
    };
    FilteringFormComponent.prototype.resetFilter = function () {
        this.context.resetFilter();
    };
    tslib_1.__decorate([
        Input()
    ], FilteringFormComponent.prototype, "context", void 0);
    tslib_1.__decorate([
        ViewChild(forwardRef(function () { return SchemaFormComponent; }), { static: false })
    ], FilteringFormComponent.prototype, "schemaFormComponent", void 0);
    FilteringFormComponent = tslib_1.__decorate([
        Component({
            selector: 'c8y-filtering-form',
            template: "<c8y-schema-form\n  [schema]=\"schema\"\n  [form]=\"form\"\n  [model]=\"model\"\n  [options]=\"options\"\n></c8y-schema-form>\n<div class=\"flex-row p-t-16\">\n  <button\n    class=\"btn btn-default btn-sm m-r-8 flex-grow\"\n    (click)=\"resetFilter()\"\n    title=\"{{ 'Reset' | translate }}\"\n    translate\n  >\n    Reset\n  </button>\n\n  <button\n    class=\"btn btn-primary btn-sm flex-grow\"\n    (click)=\"applyFilter()\"\n    [disabled]=\"canApply()\"\n    title=\"{{ 'Apply' | translate }}\"\n    translate\n  >\n    Apply\n  </button>\n</div>\n"
        })
    ], FilteringFormComponent);
    return FilteringFormComponent;
}());
export { FilteringFormComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmlsdGVyaW5nLWZvcm0uY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGM4eS9uZ3gtY29tcG9uZW50cy8iLCJzb3VyY2VzIjpbImNvcmUvZGV2aWNlLWdyaWQvZmlsdGVyaW5nLWZvcm0uY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLFVBQVUsRUFBRSxLQUFLLEVBQVUsU0FBUyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ2hGLE9BQU8sRUFBRSxHQUFHLEVBQUUsU0FBUyxFQUFFLE1BQU0sV0FBVyxDQUFDO0FBQzNDLE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxNQUFNLGdDQUFnQyxDQUFDO0FBUXJFO0lBQUE7SUE4QkEsQ0FBQztJQXJCQyx5Q0FBUSxHQUFSO1FBQ0UsSUFBTSxNQUFNLEdBQXFCLElBQUksQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDO1FBQ3ZELElBQUksQ0FBQyxNQUFNLEdBQUcsU0FBUyxDQUFDLE1BQU0sQ0FBQyxlQUFlLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDdkQsSUFBSSxDQUFDLElBQUksR0FBRyxTQUFTLENBQUMsTUFBTSxDQUFDLGVBQWUsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNuRCxJQUFJLENBQUMsS0FBSyxHQUFHLFNBQVMsQ0FBQyxNQUFNLENBQUMsbUJBQW1CLElBQUksRUFBRSxDQUFDLENBQUM7UUFDekQsSUFBSSxDQUFDLE9BQU8sR0FBRyxFQUFFLFlBQVksRUFBRSxFQUFFLGNBQWMsRUFBRSxFQUFFLFFBQVEsRUFBRSxHQUFHLEVBQUUsRUFBRSxFQUFFLENBQUM7SUFDekUsQ0FBQztJQUVELHlDQUFRLEdBQVI7UUFDRSxPQUFPLEdBQUcsQ0FBQyxJQUFJLENBQUMsbUJBQW1CLEVBQUUsb0NBQW9DLENBQUMsQ0FBQztJQUM3RSxDQUFDO0lBRUQsNENBQVcsR0FBWDtRQUNFLElBQUksQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDO1lBQ3ZCLG1CQUFtQixFQUFFLElBQUksQ0FBQyxLQUFLO1NBQ2hDLENBQUMsQ0FBQztJQUNMLENBQUM7SUFFRCw0Q0FBVyxHQUFYO1FBQ0UsSUFBSSxDQUFDLE9BQU8sQ0FBQyxXQUFXLEVBQUUsQ0FBQztJQUM3QixDQUFDO0lBNUJRO1FBQVIsS0FBSyxFQUFFOzJEQUF1QztJQUNzQjtRQUFwRSxTQUFTLENBQUMsVUFBVSxDQUFDLGNBQU0sT0FBQSxtQkFBbUIsRUFBbkIsQ0FBbUIsQ0FBQyxFQUFFLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRSxDQUFDO3VFQUEwQjtJQUZuRixzQkFBc0I7UUFKbEMsU0FBUyxDQUFDO1lBQ1QsUUFBUSxFQUFFLG9CQUFvQjtZQUM5Qix5akJBQThDO1NBQy9DLENBQUM7T0FDVyxzQkFBc0IsQ0E4QmxDO0lBQUQsNkJBQUM7Q0FBQSxBQTlCRCxJQThCQztTQTlCWSxzQkFBc0IiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIGZvcndhcmRSZWYsIElucHV0LCBPbkluaXQsIFZpZXdDaGlsZCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgZ2V0LCBjbG9uZURlZXAgfSBmcm9tICdsb2Rhc2gtZXMnO1xuaW1wb3J0IHsgU2NoZW1hRm9ybUNvbXBvbmVudCB9IGZyb20gJy4uL2Zvcm1zL3NjaGVtYS1mb3JtLmNvbXBvbmVudCc7XG5pbXBvcnQgeyBGaWx0ZXJpbmdGb3JtUmVuZGVyZXJDb250ZXh0IH0gZnJvbSAnLi4vZGF0YS1ncmlkL2NvbHVtbi9maWx0ZXJpbmctZm9ybS1yZW5kZXJlcic7XG5pbXBvcnQgeyBEZXZpY2VHcmlkQ29sdW1uIH0gZnJvbSAnLi9kZXZpY2UtZ3JpZC5tb2RlbHMnO1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdjOHktZmlsdGVyaW5nLWZvcm0nLFxuICB0ZW1wbGF0ZVVybDogJy4vZmlsdGVyaW5nLWZvcm0uY29tcG9uZW50Lmh0bWwnXG59KVxuZXhwb3J0IGNsYXNzIEZpbHRlcmluZ0Zvcm1Db21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xuICBASW5wdXQoKSBjb250ZXh0OiBGaWx0ZXJpbmdGb3JtUmVuZGVyZXJDb250ZXh0O1xuICBAVmlld0NoaWxkKGZvcndhcmRSZWYoKCkgPT4gU2NoZW1hRm9ybUNvbXBvbmVudCksIHsgc3RhdGljOiBmYWxzZSB9KSBzY2hlbWFGb3JtQ29tcG9uZW50OiBhbnk7XG5cbiAgc2NoZW1hO1xuICBmb3JtO1xuICBtb2RlbDtcbiAgb3B0aW9ucztcblxuICBuZ09uSW5pdCgpIHtcbiAgICBjb25zdCBjb2x1bW46IERldmljZUdyaWRDb2x1bW4gPSB0aGlzLmNvbnRleHQucHJvcGVydHk7XG4gICAgdGhpcy5zY2hlbWEgPSBjbG9uZURlZXAoY29sdW1uLmZpbHRlcmluZ0NvbmZpZy5zY2hlbWEpO1xuICAgIHRoaXMuZm9ybSA9IGNsb25lRGVlcChjb2x1bW4uZmlsdGVyaW5nQ29uZmlnLmZvcm0pO1xuICAgIHRoaXMubW9kZWwgPSBjbG9uZURlZXAoY29sdW1uLmV4dGVybmFsRmlsdGVyUXVlcnkgfHwge30pO1xuICAgIHRoaXMub3B0aW9ucyA9IHsgZm9ybURlZmF1bHRzOiB7IG5nTW9kZWxPcHRpb25zOiB7IGRlYm91bmNlOiAxMDAgfSB9IH07XG4gIH1cblxuICBjYW5BcHBseSgpIHtcbiAgICByZXR1cm4gZ2V0KHRoaXMuc2NoZW1hRm9ybUNvbXBvbmVudCwgJyRjb21wb25lbnRTY29wZS52bS5uZ0Zvcm0uJGludmFsaWQnKTtcbiAgfVxuXG4gIGFwcGx5RmlsdGVyKCkge1xuICAgIHRoaXMuY29udGV4dC5hcHBseUZpbHRlcih7XG4gICAgICBleHRlcm5hbEZpbHRlclF1ZXJ5OiB0aGlzLm1vZGVsXG4gICAgfSk7XG4gIH1cblxuICByZXNldEZpbHRlcigpIHtcbiAgICB0aGlzLmNvbnRleHQucmVzZXRGaWx0ZXIoKTtcbiAgfVxufVxuIl19