<div ng-controller="SmartRestListCtrl as $ctrl">
  <c8y-ui-action-bar-set>
    <c8y-smart-rest-import-template on-imported="$ctrl.onTemplateImported(template)">
    </c8y-smart-rest-import-template>

    <c8y-smart-rest-add-template on-added="$ctrl.onTemplateAdded(template)">
    </c8y-smart-rest-add-template>

    <button
      title="{{ 'Reload' | translate }}"
      type="button"
      class="btn btn-link"
      ng-click="$ctrl.loadList()"
    >
      <i c8y-icon="refresh" ng-class="{'fa-spin': $ctrl.loading}"></i> <span translate>Reload</span>
    </button>
  </c8y-ui-action-bar-set>

  <div class="c8y-empty-state text-center" ng-show="$ctrl.templates.length === 0">
    <h1 class="c8y-icon c8y-icon-smart-rest c8y-icon-duocolor"></h1>
    <h3 translate>No SmartREST templates defined yet.</h3>
    <p translate>Create or import your first SmartREST Template.</p>
    <p c8y-guide-docs>
      <small translate>
        Find out more in the
        <a c8y-guide-href="device-sdk/mqtt/#smartrest-2">Device SDK guide`KEEP_ORIGINAL`</a>.
      </small>
    </p>
  </div>

  <div class="card-group interact-grid">
    <div
      ng-repeat="template in $ctrl.templates | orderBy:'name'"
      class="col-xs-12 col-sm-4 col-md-3"
    >
      <div class="card" ng-click="$ctrl.detail(template)">
        <div class="card-actions" ng-click="$event.stopPropagation()">
          <div class="dropdown settings" uib-dropdown>
            <button
              title="{{ 'Actions' | translate }}"
              class="dropdown-toggle c8y-dropdown"
              uib-dropdown-toggle
            >
              <span><i c8y-icon="ellipsis-v"></i></span>
            </button>
            <ul class="dropdown-menu dropdown-menu-right" uib-dropdown-menu>
              <li>
                <a title="{{ 'Edit' | translate }}" href="" ng-click="$ctrl.detail(template)">
                  <i c8y-icon="edit"></i> <translate>Edit</translate>
                </a>
              </li>
              <li>
                <a title="{{ 'Export' | translate }}" href="" ng-click="$ctrl.download(template)">
                  <i c8y-icon="download"></i> <translate>Export</translate>
                </a>
              </li>
              <li>
                <a title="{{ 'Remove' | translate }}" href="" ng-click="$ctrl.remove(template)">
                  <i c8y-icon="times"></i> <translate>Remove</translate>
                </a>
              </li>
            </ul>
          </div>
        </div>

        <div class="card-header text-truncate">
          <div class="card-icon">
            <i c8y-icon="c8y-smart-rest c8y-icon-duocolor"></i>
          </div>
          <div class="card-title" title="{{ template.name }}">
            {{ template.name }}
          </div>
        </div>

        <div class="card-block">
          <div class="text-truncate">
            <label class="small" translate>ID</label> <span ng-bind="template.__externalId"></span>
          </div>

          <div class="row text-muted top-m-sm">
            <div class="col-xs-6">
              <span title="{{ 'Messages' | translate }}">
                <i c8y-icon="arrow-circle-right" class="text-primary"></i>
                <span ng-bind="$ctrl.countRequestTemplates(template)"></span>
              </span>
            </div>
            <div class="col-xs-6 text-right">
              <span title="{{ 'Responses' | translate }}">
                <i c8y-icon="arrow-circle-left" class="text-complementary"></i>
                <span ng-bind="$ctrl.countResponseTemplates(template)"></span>
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <c8y-load-more></c8y-load-more>
</div>
