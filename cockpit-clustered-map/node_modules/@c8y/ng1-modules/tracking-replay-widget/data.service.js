"use strict";function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?Object(arguments[e]):{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(e){_defineProperty(t,e,n[e])})}return t}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function asyncGeneratorStep(e,t,n,r,a,o,c){try{var i=e[o](c),u=i.value}catch(e){return void n(e)}i.done?t(u):Promise.resolve(u).then(r,a)}function _asyncToGenerator(i){return function(){var e=this,c=arguments;return new Promise(function(t,n){var r=i.apply(e,c);function a(e){asyncGeneratorStep(r,t,n,a,o,"next",e)}function o(e){asyncGeneratorStep(r,t,n,a,o,"throw",e)}a(void 0)})}}!function(){function e(r,e){var a=e.TRACKING_EVENT_FRAGMENT_TYPE,n=e.DUESSELDORF,o=e.OSM_TILE_URL;return{createMap:function(e){var t=L.tileLayer(o,{noWrap:!0});return L.map(e,{center:n,zoom:13,layers:[t]})},createDeviceMarker:function(){return L.marker(n)},createTrackingPath:function(){return L.polyline([])},renderPathSnapshot:function(e){var t=e.map,n=e.layers,r=e.points,a=e.step;if(function(e,t){_.forEach(t,e.removeLayer.bind(e))}(t,n),!_.isEmpty(r)){var o=n.marker,c=n.path,i=_.nth(r,a),u=i.lng,s=i.lat;o.setLatLng({lng:u,lat:s}),o.bindPopup("lng: ".concat(u,", lat: ").concat(s)),t.addLayer(o),c.setLatLngs(_.take(r,a+1)),t.addLayer(c),t.fitBounds(r)}},getTrackingEventsFor:function(e){return t.apply(this,arguments)},getPointsFor:function(e){return _.map(e,"c8y_Position")}};function t(){return(t=_asyncToGenerator(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.list(_objectSpread({},t,{fragmentType:a,revert:!0}));case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}}e.$inject=["c8yEvents","trackingReplayConstants"],angular.module("c8y.pocs.trackingReplayWidget").factory("trackingReplayService",e)}();