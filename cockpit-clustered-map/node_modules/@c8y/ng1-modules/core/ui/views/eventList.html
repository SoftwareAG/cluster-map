<c8y-ui-action-bar-set ng-if="!$parent.child.templateUrl && !hideHeaderActions">
  <li class="navbar-form" action-bar-position="left">
    <div class="form-group datepicker">
      <input
        title="{{ 'Date from' | translate }}"
        class="form-control"
        placeholder="{{ 'Date from' | translate }}"
        ng-model="ctrl.dateFrom"
        uib-datepicker-popup
        datepicker-options="ctrl.datePickerOptionsFrom"
        datepicker-append-to-body="true"
        show-button-bar="false"
        is-open="openFrom"
        ng-click="openFrom=true"
      />
    </div>
  </li>
  <li class="navbar-form" action-bar-position="left">
    <div class="input-group">
      <div class="form-group datepicker" style="margin-bottom:0;height: 34px;">
        <input
          title="{{ 'Date to' | translate }}"
          class="form-control"
          placeholder="{{ 'Date to' | translate }}"
          ng-model="ctrl.dateTo"
          uib-datepicker-popup
          datepicker-options="ctrl.datePickerOptionsTo"
          datepicker-append-to-body="true"
          show-button-bar="false"
          is-open="openTo"
          ng-click="openTo=true"
        />
      </div>
    </div>
  </li>
  <li class="navbar-form" action-bar-position="left">
    <div class="form-group" style="margin-bottom:0;height: 34px;">
      <input
        title="{{ 'Event type' | translate }}"
        class="form-control"
        placeholder="{{ 'Event type' | translate }}"
        ng-model="ctrl.eventType"
      />
    </div>
    <div class="input-group-btn">
      <button
        type="button"
        title="{{ 'Apply filters' | translate }}"
        class="btn btn-default"
        ng-click="filter(ctrl.dateFrom, ctrl.dateTo, ctrl.eventType)"
      >
        <i c8y-icon="filter"></i>
        {{ 'Apply`filters`' | translate }}
      </button>
      <button
        type="button"
        title="{{ 'Clear filters' | translate }}"
        class="btn btn-default"
        ng-click="clearFilter()"
        ng-if="ctrl.dateFrom || ctrl.dateTo || ctrl.eventType"
      >
        <i c8y-icon="times"></i>
        {{ 'Clear`filters`' | translate }}
      </button>
    </div>
  </li>

  <c8y-realtime-btn class="btn btn-link" subscriber-id="ctrl.subscriberId"> </c8y-realtime-btn>

  <c8y-refresh-btn></c8y-refresh-btn>
</c8y-ui-action-bar-set>

<!-- check if it is inside a widget or in a page -->
<div class="card-navbar navbar-default" ng-if="$parent.child.templateUrl">
  <div class="navbar-nav navbar-right">
    <c8y-realtime-btn subscriber-id="ctrl.subscriberId"></c8y-realtime-btn>
    <button
      type="button"
      class="btn btn-link"
      title="{{ 'Reload' | translate }}"
      data-ng-disabled="!paging.refresh"
      data-ng-click="refresh()"
    >
      <i c8y-icon="refresh" data-ng-class="{'fa-spin': refreshLoading}"></i>
    </button>
  </div>
  <form class="form-inline">
    <div class="form-group form-group-sm datepicker">
      <input
        class="form-control"
        placeholder="{{ 'From`date`' | translate }}"
        ng-model="ctrl.dateFrom"
        uib-datepicker-popup
        datepicker-options="ctrl.datePickerOptionsFrom"
        datepicker-append-to-body="true"
        show-button-bar="false"
        is-open="openFrom"
        ng-click="openFrom=true"
        style="width:105px;"
      />
    </div>
    <div class="input-group input-group-sm">
      <div class="form-group form-group-sm datepicker">
        <input
          class="form-control"
          placeholder="{{ 'To`date`' | translate }}"
          ng-model="ctrl.dateTo"
          uib-datepicker-popup
          datepicker-options="ctrl.datePickerOptionsTo"
          datepicker-append-to-body="true"
          show-button-bar="false"
          is-open="openTo"
          ng-click="openTo=true"
          style="width: 105px;"
        />
      </div>
      <div class="input-group-btn">
        <button
          type="button"
          title="{{ 'Filter by date range' | translate }}"
          class="btn btn-default"
          ng-click="ctrl.filter(ctrl.dateFrom, ctrl.dateTo, ctrl.filters.type)"
        >
          <i c8y-icon="filter"></i>
        </button>
        <button
          type="button"
          title="{{ 'Clear date range' | translate }}"
          class="btn btn-default"
          ng-click="ctrl.clearFilter(ctrl.filters.type)"
          ng-if="ctrl.dateFrom || ctrl.dateTo"
        >
          <i c8y-icon="times"></i>
        </button>
      </div>
    </div>
  </form>
</div>

<!-- empty state -->
<div
  class="c8y-empty-state"
  ng-class="{'text-center': !$parent.child.templateUrl}"
  ng-show="events.length == 0"
>
  <h1 class="c8y-icon c8y-icon-events c8y-icon-duocolor"></h1>
  <h3 ng-show="!$parent.child.templateUrl" translate>No events to display.</h3>
  <p ng-show="$parent.child.templateUrl" translate>No events to display.</p>
</div>
<!-- /.empty state -->

<div ng-class="{'card-block': $parent.child.templateUrl}">
  <div class="timeline-list list-condensed">
    <div
      class="timeline-list-item flex-row"
      ng-class="{'expanded': isOpen(evt)}"
      ng-repeat="evt in events | orderBy: ordering track by evt.id"
      ng-click="toggle(evt)"
    >
      <small class="timeline-item-date text-right">
        {{ absolute(evt) }}
      </small>
      <div class="timeline-item-content flex-row wrap">
        <div class="list-item-icon" ng-if="evt.icon">
          <c8y-event-binary-icon event="evt"></c8y-event-binary-icon>
        </div>
        <div class="list-item-actions" ng-click="$event.stopPropagation()">
          <button
            type="button"
            title="{{ 'Expand' | translate }}"
            class="collapse-btn"
            ng-click="toggle(evt)"
          >
            <i c8y-icon="chevron-down"></i>
          </button>
        </div>
        <div class="list-item-body">
          <span
            >{{ evt.text | translate }}<br class="visible-xs visible-sm" />
            <small>
              <a class="text-muted" ng-href="#/device/{{ evt.source.id }}" ng-if="!hideDevice">
                <i c8y-icon="cog"></i>{{ evt.source.name || evt.source.id }}
              </a>
            </small>
          </span>
        </div>
        <div
          class="collapse"
          style="width: 100%;"
          uib-collapse="!isOpen(evt)"
          ng-click="$event.stopPropagation()"
        >
          <div ng-if="isOpen(evt)">
            <div class="legend form-block" translate>Details</div>
            <dl class="dl-inline small text-muted">
              <dt translate>Time</dt>
              <dd>{{ evt.time | date: 'medium' }}</dd>
            </dl>
            <dl class="dl-inline small text-muted">
              <dt translate>Server creation time</dt>
              <dd>{{ evt.creationTime | date: 'medium' }}</dd>
            </dl>
            <dl
              class="dl-inline small text-muted"
              data-ng-repeat="(key, label) in getStandardKeys(evt)"
            >
              <dt style="width:100px;">{{ label | translate }}</dt>
              <dd>{{ evt[key] }}</dd>
            </dl>
            <dl class="dl-inline small text-muted" data-ng-repeat="key in getNonStandardKeys(evt)">
              <dt style="width:100px;">{{ key | humanize2 }}</dt>
              <dd>{{ evt[key] | json }}</dd>
            </dl>
            <dl ng-show="displayEventsBinary(evt)">
              <dt translate>Attachment</dt>
              <dd>
                <div class="events-binary-no-padding col-sm-10">{{ evt.c8y_IsBinary.name }}</div>
                <div class="col-sm-2">
                  <c8y-event-binary-actions
                    event="evt"
                    enable-download="true"
                  ></c8y-event-binary-actions>
                </div>
                <span class="events-binary-no-padding">
                  <c8y-event-binary-preview event="evt"></c8y-event-binary-preview>
                </span>
              </dd>
            </dl>
          </div>
        </div>
      </div>
    </div>
  </div>
  <c8y-load-more change-page-size></c8y-load-more>
</div>
