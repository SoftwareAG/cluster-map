"use strict";!function(){function e(u,c,l,t,e,n,r,i,o,a){var s,d,f={"welcome/applications":"core/applicationLinks"};function p(e){var t=e,n=(t||"").match(/^\/apps\/([^/]*\/[^/]*)/),r=n&&n[1];if(f[r]){var i=r;r=f[r],t=t.replace(i,r)}var o=r&&r.split("/").pop(),u=r&&-1<(s||[]).indexOf(r);if(t&&!l.get(t)&&!u){var c=new RegExp("/".concat(o,"$")),a=_.find(s||[],function(e){return c.test(e)});a&&(t=t.replace(r,a))}return t}function h(e){return c.when(t.invoke(e.showIf,e))}function v(e){return r.isAllowed(e)}return{getContext:function(){var e=u.deviceId,t=u.groupId,n=u.reportId,r=u.exportId,i=null,o=null;return e&&(i="device",o=e),t&&(i="group",o=t),n&&(i="report",o=n),r&&(i="exportConfiguration",o=r),{context:i,id:o}},getContextPath:function(e){return{group:"/group/".concat(e.id),device:"/device/".concat(e.id)}[e.context]},verifyPluginViewPath:function(e){var t=e&&e.replace(/\/\//g,"/");return s?c.when(p(t)):function(){var e=d||n.getCurrent().then(n.listPluginsByApplication).then(function(e){return s=_.map(e,"contextPath")});return d=e}().then(_.partial(p,t))},intersectionObjects:function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return _.filter(_.uniq(e),function(t){return _.every(n,function(e){return _.some(e,function(e){return e.id===t.id})})})},editUserUI:function(){return i({templateUrl:":::PLUGIN_PATH:::/ui/user/editUser.modal.html",title:a("Edit user"),controller:"EditUserCtrl"})},editRetentionRule:function(e){var t=e&&e.id?a("Edit retention rule"):a("Create retention rule");return i({templateUrl:":::PLUGIN_PATH:::/ui/views/editRetentionRuleModal.html",title:t,controller:"editRetentionRuleCtrl",resolve:{rule:function(){return e}}})},configureVisibility:function(t,e,n){var r=c.when(!0),i=e||"show",o=n?_.negate(_.identity):_.identity;return t.showIfPermissions&&(r=r.then(_.partial(v,t.showIfPermissions)).then(function(e){return e?c.when(!0):c.reject()})),t.showIf&&(r=r.then(_.partial(h,t))),r.catch(_.constant(!1)).then(function(e){return _.set(t,i,o(e))})},instanceOptions:function(){return _.merge({},window.C8Y_APP&&window.C8Y_APP.C8Y_INSTANCE_OPTIONS,window.C8Y_INSTANCE_OPTIONS)},escapeForRegex:function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},shouldShowSmartRules:o.shouldShowLocalSmartRules,shouldShowEventProcessing:function(){return n.isAvailable(function(e){return"MICROSERVICE"===e.type&&"cep"===e.contextPath&&!_.includes(e.name,"apama")})},emitWindowResize:function(){if(Event.prototype.initEvent){var e=window.document.createEvent("UIEvents");e.initUIEvent("resize",!0,!1,window,0),window.dispatchEvent(e)}else window.dispatchEvent(new Event("resize"))},waitForPropertyResolve:function(e,t){var n=c.defer(),r=e.$watch(function(){return _.get(e,t)},function(e){r(),n.resolve(e)});return n.promise},stripHtmlTags:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=document.createElement("DIV");return t.innerHTML=e,t.textContent||t.innerText||""}}}e.$inject=["$routeParams","$q","$templateCache","$injector","$http","c8yApplication","c8yPermissions","c8yModal","c8ySmartRulesAvailability","gettext"],angular.module("c8y.ui").factory("c8yUiUtil",e)}();