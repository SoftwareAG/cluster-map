"use strict";function _objectSpread(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?Object(arguments[e]):{},r=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.forEach(function(e){_defineProperty(n,e,t[e])})}return n}function _defineProperty(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}!function(){function e(i,u,l,e,r){var n,t="tenant/",s="".concat(t,"tenants"),a="".concat(t,"currentTenant"),c="management",o=1e3,f=["applications","ownedApplications","adminName"],p=["allowCreateTenants"],d=["adminPass"],v=l.cleanFields;return{list:function e(n){var t=l.pageSizeFilter(_objectSpread({},n,{pageSize:o,currentPage:_.get(n,"currentPage")}));var r={params:t};var a=l.url(s);var c=l.cleanListCallback("tenants",e,t);return i.get(a,r).then(c)},save:function(e){var n=_.cloneDeep(e),t=!n.applications,r=t?"post":"put",a=n.allowCreateTenants;n.adminPass||(n=v(n,d));n=v(n,t?p:f);var c=l.url(s)+(t?"":"/".concat(n.id)),o={headers:l.contentHeaders("tenant",!0)};return n=v(n,["id"]),u.resolve(n).then(function(e){return i[r](c,e,o)}).then(function(e){var n=u.resolve(e);return t&&a&&(n=n.then(function(e){return function(e,n,t,r){var a=e.data.id,c="".concat(n,"/").concat(a);return i.put(c,{allowCreateTenants:r},t)}(e,c,o,a)}).then(function(){return e})),n})},remove:function(e){var n=b(e);return i.delete(n)},detail:function(e){var n=b(e);return i.get(n)},addApplication:function(e,n,t){var r=n.id||n,a=m(e),c={application:{id:r,self:n.self}},o=_objectSpread({headers:l.contentHeaders("applicationReference",!0)},t);return i.post(a,c,o)},removeApplication:function(e,n,t){var r=n.id||n,a="".concat(m(e),"/").concat(r);return i.delete(a,t)},isCurrentUserTopTenant:function(){return e.current().then(function(e){return g(e.tenant)})},isParentTopTenant:function(e){return g(e.parent)},isTopTenant:g,current:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];n&&!e||(n=i.get(l.url(a),{silentError:!0}).then(l.getResData,function(e){return 404===e.status?u.when({allowsCreateSubtenant:!0}):u.reject(e)}));return n},isEnterpriseEditionTenant:function(){var n={name:"feature-branding"},t=[{name:"sslmanagement"},{name:"feature-user-hierarchy"},{name:"feature-broker"}];return r.areAllAvailable([{name:"branding"}].concat(t)).then(function(e){return e||r.areAllAvailable([n].concat(t))})}};function b(e){var n=e.id||e;return l.url("".concat(s,"/").concat(n))}function m(e){return"".concat(b(e),"/applications")}function g(e){return e===c}}e.$inject=["$http","$q","c8yBase","c8yUser","c8yApplication"],angular.module("c8y.core").factory("c8yTenant",e)}();