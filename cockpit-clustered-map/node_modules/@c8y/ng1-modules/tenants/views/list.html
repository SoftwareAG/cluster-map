<c8y-ui-action-bar-set>
  <li class="navbar-form hidden-xs" action-bar-position="left">
    <c8y-list-display-control
      list-length="vm.tenants.length"
      on-list-class-change="vm.listClass = listClass"
    >
    </c8y-list-display-control>
  </li>

  <li class="navbar-form" action-bar-position="left" ng-show="vm.tenants.length > 0">
    <div class="input-group input-group-search">
      <input
        title="{{ 'Filter' | translate }}"
        type="search"
        class="form-control"
        placeholder="{{ 'Filter tenants' | translate }}"
        ng-model="vm.searchString"
      />
      <span class="input-group-addon">
        <i
          c8y-icon="search"
          ng-show="vm.searchString.length === 0 || !vm.searchString "
          class="fa fw fa-search"
        ></i>
        <i
          c8y-icon="times"
          class="text-muted fa fw fa-times ng-hide"
          ng-show="vm.searchString.length > 0"
          ng-click="vm.searchString = ''"
        ></i>
      </span>
    </div>
  </li>

  <a title="{{ 'Create tenant' | translate }}" href="" class="btn btn-link" ng-click="add()">
    <i c8y-icon="plus-circle"></i> {{ 'Create tenant' | translate }}
  </a>

  <c8y-download-emails-list></c8y-download-emails-list>

  <c8y-refresh-btn></c8y-refresh-btn>
</c8y-ui-action-bar-set>

<div class="c8y-empty-state text-center" ng-show="tenants.length == 0">
  <h1 class="c8y-icon c8y-icon-sub-tenants c8y-icon-duocolor"></h1>
  <h3 translate>No tenants to display.</h3>
  <p translate>Click below to create your first tenant.</p>
  <button title="{{ 'Create tenant' | translate }}" class="btn btn-primary" ng-click="add()">
    <i c8y-icon="plus-circle"></i> {{ 'Create tenant' | translate }}
  </button>
</div>

<div class="card-group" ng-class="vm.listClass">
  <div
    class="col-xs-12 col-sm-6 col-md-4"
    ng-repeat="tenant in tenants|orderBy:'company' | filter:vm.searchString as filtered track by tenant.id"
  >
    <div class="card" ng-click="detail(tenant)">
      <div class="card-actions" ng-click="$event.stopPropagation();">
        <div class="dropdown settings" uib-dropdown="">
          <button
            title="{{ 'Actions' | translate }}"
            class="dropdown-toggle c8y-dropdown"
            uib-dropdown-toggle=""
            ng-click="::$event.stopPropagation()"
            aria-haspopup="true"
            aria-expanded="false"
          >
            <i c8y-icon="ellipsis-v" class="fa fw fa-ellipsis-v"></i>
          </button>
          <ul
            class="dropdown-menu dropdown-menu-right"
            uib-dropdown-menu
            ng-click="::$event.stopPropagation();"
          >
            <li>
              <a href="" title="{{ 'Edit tenant' | translate }}" ng-click="detail(tenant)">
                <i c8y-icon="pencil"></i> {{ 'Edit`tenant`' | translate }}
              </a>
            </li>
            <li>
              <a
                href=""
                title="{{ 'Suspend tenant' | translate }}"
                ng-click="suspendTenant(tenant)"
                ng-show="tenant.status === TENANT_STATUS.ACTIVE.value"
              >
                <i c8y-icon="power-off"></i> {{ 'Suspend`tenant`' | translate }}
              </a>
              <a
                href=""
                title="{{ 'Activate tenant' | translate }}"
                ng-click="activateTenant(tenant)"
                ng-show="tenant.status === TENANT_STATUS.SUSPENDED.value"
              >
                <i c8y-icon="power-off"></i> {{ 'Activate`tenant`' | translate }}
              </a>
            </li>
            <li>
              <a
                href=""
                title="{{ 'Delete tenant' | translate }}"
                ng-click="::$event.stopPropagation(); onClickDelete(tenant)"
                ng-if="isTopTenant"
              >
                <i c8y-icon="trash"></i> {{ 'Delete`tenant`' | translate }}
              </a>
            </li>
          </ul>
        </div>
      </div>

      <div class="card-header text-truncate">
        <div class="card-icon">
          <i c8y-icon="c8y-sub-tenants c8y-icon-duocolor"></i>
        </div>
        <h4 class="card-title text-truncate" title="{{ tenant.company }}">
          {{ tenant.company }}
        </h4>
      </div>
      <hr />

      <div class="card-block card-block-list">
        <div class="text-truncate">
          <label class="small" translate>ID</label>
          <span title="{{ tenant.id }}">{{ tenant.id }}</span>
        </div>
        <div class="text-truncate">
          <label class="small" translate>Domain</label>
          <span title="{{ tenant.domain }}">{{ tenant.domain }}</span>
        </div>

        <div ng-if="tenant.contactName" class="text-truncate">
          <label class="small" translate>Contact name</label>
          <span title="{{ tenant.contactName }}">{{ tenant.contactName }}</span>
        </div>
        <div ng-if="tenant.contactPhone" class="text-truncate">
          <label class="small" translate>Phone</label>
          <span title="{{ tenant.contactPhone }}">{{ tenant.contactPhone }}</span>
        </div>
        <div
          ng-if="tenant.customProperties && tenant.customProperties.externalReference"
          class="text-truncate"
        >
          <label class="small" translate>External reference</label>
          <span
            class="externalReferenceValue"
            title="{{ tenant.customProperties.externalReference }}"
          >
            {{ tenant.customProperties.externalReference }}
          </span>
        </div>
        <div ng-if="isTopTenant" class="text-truncate">
          <label class="small" translate>Parent tenant</label>
          <span title="{{ tenant.parent }}">{{ tenant.parent }}</span>
        </div>
      </div>
      <div class="card-footer separator">
        <div class="tight-grid">
          <div class="col-xs-8">
            <label class="small" translate>Created</label>
            <small>{{ tenant.creationTime | absoluteDate }}</small>
          </div>
          <div class="col-xs-4 text-right">
            <span ng-show="tenant.status === TENANT_STATUS.ACTIVE.value">
              <i c8y-icon="check-circle text-success"></i>
              <small>{{ TENANT_STATUS[tenant.status].label | translate }}</small>
            </span>
            <span ng-show="tenant.status === TENANT_STATUS.SUSPENDED.value">
              <i c8y-icon="times-circle text-danger"></i>
              <small>{{ TENANT_STATUS[tenant.status].label | translate }}</small>
            </span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<c8y-load-more></c8y-load-more>
