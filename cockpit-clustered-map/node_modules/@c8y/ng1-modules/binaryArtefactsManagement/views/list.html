<div ng-controller="binaryArtefactsListCtrl as vm">
  <c8y-ui-action-bar-set>
    <li class="navbar-form" action-bar-position="left" ng-show="files.length > 0">
      <div class="input-group input-group-search">
        <input
          title="{{ 'Filter' | translate }}"
          type="search"
          class="form-control"
          placeholder="{{ 'Filter' | translate }}&hellip;"
          ng-model="vm.searchString"
        />
        <span class="input-group-addon">
          <i c8y-icon="search" ng-show="vm.searchString.length === 0 || !vm.searchString "></i>
          <i
            c8y-icon="times"
            class="text-muted"
            ng-show="vm.searchString.length > 0"
            ng-click="vm.searchString = ''"
          ></i>
        </span>
      </div>
    </li>

    <li c8y-if-allowed any-role="['ROLE_INVENTORY_ADMIN', 'ROLE_INVENTORY_CREATE']">
      <button title="{{ 'Upload file' | translate }}" class="btn btn-link" ng-click="upload()">
        <i c8y-icon="upload"></i> <translate>Upload file</translate>
      </button>
    </li>

    <c8y-refresh-btn></c8y-refresh-btn>
  </c8y-ui-action-bar-set>

  <div class="c8y-empty-state text-center" ng-show="files.length == 0">
    <h1 c8y-icon="c8y-archive" class="c8y-icon-duocolor"></h1>
    <h3 translate>No files to display.</h3>
  </div>

  <div class="list-group">
    <div class="card" ng-show="filtered.length === 0 && files.length > 0">
      <div class="c8y-empty-state text-left">
        <h1 class="c8y-icon c8y-icon-archive c8y-icon-duocolor"></h1>
        <p translate>
          No files found containing <strong>{{ vm.searchString }}</strong
          >.
        </p>
      </div>
    </div>

    <div
      class="list-group-item flex-row"
      ng-repeat="file in files | orderBy:'name' | filter:vm.searchString as filtered "
    >
      <div class="list-item-actions">
        <div class="settings pull-right dropdown" uib-dropdown is-open="menuOpen">
          <button
            type="button"
            title="{{ 'Actions' | translate }}"
            class="dropdown-toggle c8y-dropdown"
            uib-dropdown-toggle
          >
            <i c8y-icon="ellipsis-v"></i>
          </button>
          <ul class="dropdown-menu" uib-dropdown-menu>
            <li>
              <c8y-download-button binary="file" downloading="file.downloading">
              </c8y-download-button>
            </li>
            <li ng-show="!file.downloading">
              <a
                href=""
                ng-disabled="file.c8y_applications_storage"
                title="{{ 'Delete' | translate }}"
                ng-click="onClickDelete(file)"
              >
                <i c8y-icon="trash"></i> {{ 'Delete' | translate }}
              </a>
            </li>
          </ul>
        </div>
      </div>

      <div class="list-item-icon">
        <i c8y-icon="{{ file.icon }}"></i>
      </div>

      <div class="list-item-body">
        <div class="row">
          <div class="col-sm-4 col-xs-12">
            <div
              class="text-truncate"
              title="{{ file.name }}, {{ 'Owner' | translate }}: {{ file.owner }}"
            >
              {{ file.name }}
              <br />
              <label class="small" translate>Owner</label> <small>{{ file.owner }}</small>
            </div>
          </div>

          <div class="col-sm-1 col-xs-12">
            <span ng-show="isImage(file)">
              <a
                href=""
                ng-click="toggle(file)"
                uib-popover-template="popoverTemplateUrl"
                popover-placement="auto"
                popover-append-to-body="true"
                popover-trigger="'focus'"
                title="{{ 'Preview file' | translate }}"
                class="btn btn-default btn-xs visible-xs-block visible-sm-inline-block visible-md-inline-block visible-lg-inline-block"
              >
                <i c8y-icon="search"></i>
              </a>
            </span>
          </div>

          <div class="col-sm-4 col-xs-12">
            <div class="text-truncate">
              <label class="small" translate>Type</label> <small>{{ file.type }}</small>
              <br />
              <label class="small" translate>Size</label> <small>{{ size(file) | bytes }}</small>
            </div>
          </div>

          <div class="col-sm-3 col-xs-12">
            <small class="text-muted " title="{{ 'Last update' | translate }}">
              <i c8y-icon="calendar"></i> {{ file.lastUpdated | absoluteDate }}
            </small>
          </div>
        </div>
      </div>
    </div>
  </div>

  <c8y-load-more></c8y-load-more>
</div>
