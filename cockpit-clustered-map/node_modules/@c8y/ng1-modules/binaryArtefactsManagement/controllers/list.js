"use strict";angular.module("c8y.binaryArtefactsManagement").controller("binaryArtefactsListCtrl",["$scope","c8yModal","c8yBase","c8yTitle","c8yBinary","gettext","gettextCatalog",function(t,n,i,e,a,o,l){var r,s=[];function c(e){t.files&&!t.refreshLoading||(t.files=[]),t.paging=e.paging,e.forEach(function(e){e.icon=a.icon(e),t.files.push(e)})}function f(){e.changeTitle({title:o("Files repository")})}function g(){t.refreshLoading=!0,t.paging.refresh().then(c).finally(function(){t.refreshLoading=!1})}function u(e){return s.indexOf(e)}function d(e){return-1<u(e)}t.loadNext=function(){t.paging.loading=!0,t.paging.next().then(c).finally(function(){t.paging.loading=!1})},t.refresh=g,t.toggle=function(e){d(e)?s.splice(u(e),1):(s.push(e),function(t){a.isImage(t)&&!t.dataUri&&a.downloadAsDataUri(t).then(function(e){t.dataUri=e})}(e))},t.isOpen=d,t.onClickDelete=function(e){n({title:o("Delete file"),body:l.getString('You are about to delete file "{{name}}". Do you want to proceed?',e),status:"danger",labels:{ok:o("Delete")}}).then(angular.bind(a,a.removeBinary,e)).then(angular.bind(i,i.removeFromList,t.files,e))},t.upload=function(){n({templateUrl:":::PLUGIN_PATH:::/views/upload.html",controller:"binaryArtefactsUploadCtrl",title:o("Upload files"),backdrop:"static"}).then(g)},t.size=a.size,t.isImage=a.isImage,t.popoverTemplateUrl=":::PLUGIN_PATH:::/views/popover.html",a.list(r).then(c).then(f)}]);