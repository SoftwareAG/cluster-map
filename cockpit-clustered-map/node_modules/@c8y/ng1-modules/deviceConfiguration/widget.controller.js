"use strict";!function(){function n(i,e,o,a,r,u,c){function t(n){return o.supportsOperation(i.device,n)}function f(n,t){return n.deviceId=i.device.id,a.createWithNotifications(n).then(function(n){return n.created.then(function(){r.success(t)}),n})}i.visible=function(){var n=!1;return i.device&&(n=function(n){return i.device&&!_.isUndefined(i.device[n])}("c8y_Configuration")||t("c8y_Configuration")||t("c8y_SendConfiguration")),n},i.supportsOperation=t,i.configuration=function(n){f({description:u("Configuration update"),c8y_Configuration:{config:n}},u("Configuration will be updated.")).then(function(n){n.created.then(function(){i.savingConfiguration=!0}),n.completed.then(function(n){if(n.status===a.status.SUCCESSFUL)r.success(u("Configuration saved."));else if(n.status===a.status.FAILED){var t=c.getString("Failed to save configuration.");n.failureReason&&(t=c.getString('Failed to save configuration: "{{failureReason | translate}}".',n)),r.danger(t)}i.savingConfiguration=!1})})},i.reloadConfiguration=function(){f({description:u("Requested current configuration"),c8y_SendConfiguration:{}},u("Configuration will be reloaded.")).then(function(n){n.created.then(function(){i.reloadingConfiguration=!0}),n.completed.then(function(n){if(n.status===a.status.SUCCESSFUL)o.detail(i.device.id).then(e.getResData).then(function(n){i.device.c8y_Configuration=n.c8y_Configuration,r.success(u("Configuration reloaded.")),i.reloadingConfiguration=!1});else if(n.status===a.status.FAILED){var t=c.getString("Failed to reload configuration.");n.failureReason&&(t=c.getString('Failed to reload configuration: "{{failureReason | translate}}".',n)),r.danger(t),i.reloadingConfiguration=!1}})})}}n.$inject=["$scope","c8yBase","c8yDevices","c8yDeviceControl","c8yAlert","gettext","gettextCatalog"],angular.module("c8y.deviceConfiguration").controller("deviceConfigurationWidgetCtrl",n)}();