<c8y-ui-title-set title="::vm.role.name"></c8y-ui-title-set>

<c8y-breadcrumbs-set>
  <c8y-breadcrumbs-item
    path="#roles"
    label="{{ 'Roles' | translate }}"
    icon="c8y-users"
  ></c8y-breadcrumbs-item>
  <c8y-breadcrumbs-item
    path="#roles/global_roles"
    label="{{ 'Global roles' | translate }}"
    icon="universal-access"
  ></c8y-breadcrumbs-item>
</c8y-breadcrumbs-set>

<div class="row">
  <form name="vm.globalRoleDetailForm">
    <div class="col-md-6">
      <div class="card">
        <div class="card-block">
          <div class="form-group">
            <label translate>Name</label>
            <input
              name="name"
              placeholder="{{ 'e.g. My global role' | translate }}"
              required
              class="form-control"
              ng-maxlength="254"
              ng-model="vm.role.name"
            />
            <c8y-error-feedback field="vm.globalRoleDetailForm.name"></c8y-error-feedback>
          </div>
          <div class="form-group">
            <label translate>Description</label>
            <textarea
              name="description"
              class="form-control"
              style="height:140px;"
              ng-maxlength="1000"
              ng-model="vm.role.description"
            ></textarea>
            <c8y-error-feedback field="vm.globalRoleDetailForm.description"></c8y-error-feedback>
          </div>
        </div>
      </div>

      <p translate>
        This role has access to the applications selected below.
      </p>
      <p class="alert alert-info" ng-show="vm.hasAppPermissions()" translate>
        This role already has access to all applications. Revoke all "Application management"
        permissions to grant access only to some applications.
      </p>
      <br />
      <div class="card">
        <c8y-application-access
          allowed-applications="vm.role.applications"
          disabled-edit="vm.hasAppPermissions()"
          c8y-check-dirty="vm.role.applications"
        >
        </c8y-application-access>
      </div>
    </div>
    <div class="col-md-6">
      <p class="bottom-m-sm">
        <span translate>
          A <strong>global role</strong> contains generally applicable permissions. For example,
          select "Read" in the "Inventory" row to allow users with this role to read all objects in
          inventory.
        </span>
        <br />
        <small title="{{ 'Help &amp; documentation' | translate }}" ng-show="::vm.helpLink">
          <a ng-href="{{::vm.helpLink}}" target="_blank" rel="noopener noreferrer">
            <i c8y-icon="question-circle-o"></i>
            <span translate>Help &amp; documentation</span>
          </a>
        </small>
      </p>
      <div class="card">
        <c8y-roles-matrix
          available-roles="vm.permissions"
          selected-roles="vm.selectedPermissions"
          on-selected-roles-change="vm.onSelectedRolesChange(selectedRoles)"
        >
        </c8y-roles-matrix>
      </div>
    </div>
  </form>
</div>

<div class="page-footer text-center">
  <c8y-ui-button-footer>
    <button
      title="{{ 'Cancel' | translate }}"
      type="button"
      class="btn btn-default"
      ng-click="vm.cancel()"
      ng-disabled="vm.saving"
      translate
    >
      Cancel
    </button>
    <button
      title="{{ 'Save' | translate }}"
      type="button"
      class="btn btn-primary"
      ng-click="vm.save()"
      ng-disabled="vm.saving || vm.globalRoleDetailForm.$invalid || (vm.role.id && vm.globalRoleDetailForm.$pristine)"
      translate
    >
      Save
    </button>
  </c8y-ui-button-footer>
</div>
