<div ng-controller="c8yRetentionRulesListCtrl as vm">
  <c8y-ui-action-bar-set>
    <li c8y-if-allowed any-role="['ROLE_RETENTION_RULE_ADMIN']">
      <button 
        title="{{ 'Add rule' | translate }}" 
        ng-click="createModal()" 
        class="btn btn-link"
      >
        <i c8y-icon="plus-circle"></i> <translate>Add rule</translate>
      </button>
    </li>
    <button
      title="{{ 'Reload' | translate }}"
      type="button"
      class=" btn btn-link"
      ng-disabled="!paging.refresh"
      ng-click="list()"
    >
      <i c8y-icon="refresh" ng-class="{'fa-spin': refreshLoading}"></i>
      <translate>Reload</translate>
    </button>
  </c8y-ui-action-bar-set>

  <div class="c8y-empty-state text-center" ng-show="retentions.length === 0">
    <h1 c8y-icon="briefcase"></h1>
    <h3 translate>No retention rules to display.</h3>
    <p translate>Add your first retention rule by clicking below.</p>
    <button class="btn btn-primary" ng-click="createModal()" translate>Add retention rule</button>
    <p class="top-m-xs" c8y-guide-docs>
      <small translate
        >Find out more in the
        <a c8y-guide-href="reference/retention-rules/">Reference guide`KEEP_ORIGINAL`</a>.</small
      >
    </p>
  </div>

  <div class="list-group">
    <div
      class="list-group-item flex-row"
      ng-repeat="rule in retentions"
      ng-click="updateModal(rule)"
      title="{{ 'Click to edit' | translate }}"
    >
      <div class="list-item-icon text-gray-darker">
        <i c8y-icon="{{ rule.icon || 'briefcase' }}"></i>
      </div>
      <div class="list-item-body row">
        <div class="col-sm-4 col-xs-12 col-md-3">
          {{ rule.dataType | translate }}
        </div>

        <div class="col-sm-4 col-md-2 col-xs-12">
          <label class="small" translate>Fragment type</label> {{ rule.fragmentType }}
        </div>

        <div class="col-sm-4 col-md-2 col-xs-12">
          <label class="small" translate>Type</label> {{ rule.type }}
        </div>

        <div class="col-sm-4 col-md-2 col-xs-12">
          <label class="small" translate>Source</label> {{ rule.source }}
        </div>

        <div class="col-sm-4 col-md-2 col-xs-12">
          <label class="small" translate>Maximum age</label> {{ rule.maximumAge }}
          {{ 'days' | translate }}
        </div>
        <div class="col-sm-4 col-md-1 text-right" ng-hide="isEditable(rule)">
          <span class="label label-info" translate>Not editable</span>
        </div>

        <div class="text-right showOnHover col-sm-4 col-md-1" ng-show="isEditable(rule)">
          <button
            class="btn btn-danger btn-xs hidden-xs"
            data-ng-click="removeWithConfirmation(rule);$event.stopPropagation()"
            uib-tooltip="{{ 'Delete' | translate }}"
          >
            <i c8y-icon="trash"></i>
          </button>
        </div>
      </div>
      <button
        class="btn btn-danger btn-xs btn-block visible-xs "
        data-ng-click="removeWithConfirmation(rule);$event.stopPropagation()"
      >
        <i c8y-icon="trash"></i> {{ 'Delete' | translate }}
      </button>
    </div>
  </div>
</div>
