"use strict";function _objectSpread(n){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?Object(arguments[e]):{},t=Object.keys(s);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(s).filter(function(e){return Object.getOwnPropertyDescriptor(s,e).enumerable}))),t.forEach(function(e){_defineProperty(n,e,s[e])})}return n}function _defineProperty(e,n,s){return n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}!function(){function e(e,n,s,o,r,t,i,l){var a=this;function c(){n.listInventoryRoles(a.user).then(s.getResData).then(function(e){a.assignedRoles=_.keyBy(e.inventoryAssignments,"managedObject")}),n.detail(a.user).then(s.getResData).then(function(e){e.owner&&n.listInventoryRoles(e.owner).then(s.getResData).then(function(e){a.ownerAssignedRoles=_.keyBy(e.inventoryAssignments,"managedObject"),_.isEmpty(a.ownerAssignedRoles)&&(a.displayNoOwnerRolesAlert=!0)})})}function u(){c(),i.success(l.getPlural(y(),"Inventory role updated","Inventory roles updated",{}))}function y(){return _.filter(a.assignedRoles,"isModified").length}function g(e){var n="replace"===e.process,s=e.roles,t=_.map(a.assignedRoles);return o.copyUserRoles(s,t,a.user,n).then(c).then(r.successUserRolesCopy)}_.assign(a,{$onChange:function(e){e.user&&c()},onChangeRoles:function(e,n){a.assignedRoles[n]=a.assignedRoles[n]||{},_.assign(a.assignedRoles[n],{managedObject:n,roles:e,isModified:!0}),a.assignedRoles=_objectSpread({},a.assignedRoles)},onSaveInventoryRoles:function(){o.onSaveInventoryRoles(a.user,a.assignedRoles).then(u)},copyRoles:function(){r.copyFromUserDialog(a.user).then(g)},loadAssignedRoles:c,isUnchanged:function(){return 0===y()},helpLink:t.getUserGuideLink(_.get(r.STRINGS,"LINKS.ROLES_INVENTORY")),displayNoOwnerRolesAlert:!1}),c()}e.$inject=["$q","c8yUser","c8yBase","c8yUserInventoryRoles","c8yUserRolesUi","c8yDocs","c8yAlert","gettextCatalog"],angular.module("c8y.userRoles").component("c8yUserInventoryRolesTab",{templateUrl:":::PLUGIN_PATH:::/inventoryRolesTab/inventoryRolesTab.html",controllerAs:"vm",controller:e,bindings:{user:"<"}})}();