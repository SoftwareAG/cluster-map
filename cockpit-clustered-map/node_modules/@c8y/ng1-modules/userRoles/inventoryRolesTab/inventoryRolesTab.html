<c8y-breadcrumbs-set>
  <c8y-breadcrumbs-item
    path="#users"
    label="{{ 'Users' | translate }}"
    icon="c8y-user"
  ></c8y-breadcrumbs-item>
</c8y-breadcrumbs-set>

<div class="row">
  <div class="col-md-8">
    <div class="card">
      <div class="card-header">
        <h4 class="card-title" translate>Assign inventory roles to device groups</h4>
      </div>
      <hr />
      <div class="card-block overflow-visible">
        <p translate class="bottom-m">
          The user will be granted access to the listed device groups as allowed by the assigned
          inventory roles. Use dropdown to select which roles should be applied to each group and
          its children.
        </p>
        <div
          title="{{ 'Filter device groups…' | translate }}"
          class="input-group input-group-search"
        >
          <input
            class="form-control"
            placeholder="{{ 'Filter device groups…' | translate }}"
            ng-model="searchTearm"
          />
          <span class="input-group-addon">
            <i
              c8y-icon="search"
              ng-class="{'fa-spin': loading}"
              ng-show="searchTearm === 0 || !searchTearm"
            >
            </i>
            <i
              c8y-icon="times"
              class="text-muted"
              ng-show="searchTearm.length > 0"
              ng-click="searchTearm = ''"
            >
            </i>
          </span>
        </div>
        <c8y-roles-asset-tree
          owner-assigned-roles="vm.ownerAssignedRoles"
          search-filter="searchTearm"
          assigned-roles="vm.assignedRoles"
          on-change-roles="vm.onChangeRoles(roles, managedObjectId)"
        >
        </c8y-roles-asset-tree>

        <div class="alert alert-info" ng-show="vm.displayNoOwnerRolesAlert" translate>
          No device groups available due to the device owner permissions. The device owner must be
          granted access to some device groups first.
        </div>
      </div>
    </div>
    <div class="text-center page-footer">
      <c8y-ui-button-footer>
        <button
          title="{{ 'Cancel' | translate }}"
          ng-click="vm.loadAssignedRoles()"
          type="button"
          class="btn btn-default"
          translate
        >
          Cancel
        </button>
        <button
          title="{{ 'Save' | translate }}"
          type="submit"
          class="btn btn-primary"
          translate
          ng-disabled="vm.isUnchanged()"
          ng-click="vm.onSaveInventoryRoles()"
        >
          Save
        </button>
      </c8y-ui-button-footer>
    </div>
  </div>

  <div class="col-md-4">
    <div>
      <p translate class="m-b-8">
        An <strong>inventory role</strong> contains permissions that can be attached to devices and
        groups of devices. You can define own inventory roles <a href="#/roles">here</a>.
      </p>
      <p translate>
        You can also copy inventory roles from another user or replace this user's roles with the
        roles of another user.
      </p>
    </div>

    <p ng-show="::vm.helpLink">
      <small>
        <a
          title="{{ 'Help &amp; documentation' | translate }}"
          ng-href="{{::vm.helpLink}}"
          target="_blank"
          rel="noopener noreferrer"
        >
          <i c8y-icon="question-circle-o"></i> <span translate>Help &amp; documentation</span>
        </a>
      </small>
    </p>

    <button
      title="{{ 'Copy inventory roles from another user' | translate }}"
      type="button"
      class="btn btn-primary m-t-16"
      ng-click="vm.copyRoles()"
      translate
    >
      Copy inventory roles from another user
    </button>
  </div>
</div>
