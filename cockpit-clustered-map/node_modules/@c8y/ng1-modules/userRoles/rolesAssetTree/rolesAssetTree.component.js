"use strict";!function(){function e(n,e){var s=this;_.assign(s,{filterAsset:function(e){return!s.ownerAllAssignedRoles||_.get(s.ownerAllAssignedRoles,[e.id,"length"])},onApply:function(e,n){return s.onChangeRoles({managedObjectId:n,roles:e})},$onChanges:function(e){(e.assignedRoles||e.ownerAssignedRoles)&&t.then(o)}});var t=n.getAssetTree().then(function(e){s.flatAssetTree=n.flatTree(e)});function o(){if(s.assignedRoles&&(s.inheritedRoles=r(s.flatAssetTree,s.assignedRoles)),s.ownerAssignedRoles){var e=r(s.flatAssetTree,s.ownerAssignedRoles);s.ownerAllAssignedRoles=_.mergeWith(e,s.ownerAssignedRoles,function(e,n){return n?e?_.uniqBy(e.concat(n.roles),"id"):n.roles:e})}}function r(e,s){return _.reduce(e,function(e,n){return e[n.id]=_(n._parentGroups).map(function(e){return _.get(s,e.id)}).filter(_.identity).map(_.property("roles")).flatten().uniqBy("id").value(),e},{})}e.list().then(function(e){s.inventoryRoles=e})}e.$inject=["c8yUserInventoryRoles","c8yRoles"],angular.module("c8y.userRoles").component("c8yRolesAssetTree",{templateUrl:":::PLUGIN_PATH:::/rolesAssetTree/rolesAssetTree.html",controllerAs:"vm",controller:e,bindings:{searchFilter:"<",assignedRoles:"<",ownerAssignedRoles:"<",onChangeRoles:"&"}})}();