"use strict";!function(){e.$inject=["c8yDeviceProtocolUiProvider","c8yViewsProvider","gettext"];var o="c8yImpact";function e(e,t,f){n.$inject=["c8yApplication","c8yBase","c8yInventory","c8yObjectMappings","c8yModal","c8yAlert","gettextCatalog","$q","$http"],r.$inject=["$routeParams"];var c={service:o,id:"impact",name:f("IMPACT")},h={path:"/deviceprotocols/".concat(c.id,"/:id"),template:'<c8y-impact-detail id="vm.id"></c8y-impact-detail>',controllerAs:"vm",controller:r};return{initUi:function(){e.register(c),t.when(h.path,h)},$get:n};function r(e){_.assign(this,e)}function n(e,r,c,n,o,t,a,i,u){var s,l=r.url("service/impact/"),d="".concat(l,"objectResourceMappings"),p="".concat(d,"/json"),v=[f("BOOLEAN"),f("STRING"),f("INTEGER"),f("FLOAT")];return{showIf:function e(){e.cached||(e.cached=g());return e.cached},isServiceAvailable:g,flow:_.constant(["c8yImpactCreateStep"]),detail:function(e){var t=r.getId(e);return c.detail(t).then(r.getResData)},detailPath:function(e){var t=r.getId(e);return h.path.replace(/:id$/,t)},create:function(e){var t=n.createManagedObject(e);return t.type="impact_object_mapping",u.post(p,t).then(r.getResData)},save:function(e){var t=n.fragments.BASE_FRAGMENT,c=_.pick(e,["id",t]);if(!_.get(c,t))throw new Error("c8yImpact.save: ".concat(t," is not defined"));if(_.get(c,"id"))return u.post(p,c).then(r.getResData);throw new Error("c8yImpact.save: Id is not defined")},remove:c.remove,removeResourceConfirm:function(t){var e={title:f("Delete resource"),body:a.getString('You are about to delete the resource with the ID "{{id}}". Do you want to proceed?',t),status:"danger",labels:{ok:f("Delete"),cancel:f("Cancel")}};return o(e).then(function(e){return e?t:i.reject()})},overwriteResourceConfirm:function(t){var e={title:f("Overwrite resource"),body:a.getString('You are about to overwrite the resource with the ID "{{id}}". Do you want to proceed?',t),status:"warning",labels:{ok:f("Overwrite"),cancel:f("Cancel")}};return o(e).then(function(e){return e?t:i.reject()})},list:function(){return u.get(d,{silentError:!0}).then(r.getResData)},getName:n.getName,DATA_TYPES:v,alertRemoveResourceSuccess:function(){var e=f("Resource deleted.");t.success(e)},alertUpdateProtocolSuccess:function(){var e=f("Device protocol updated");t.success(e)},listRowInfoComponent:"c8yDeviceProtocolRowCountResources",getCustomActions:function(){s||(s=u.get("".concat(l,"mappingActions/resourceactions")).then(r.getResData).then(m));return s}};function g(){return e.isAvailable({name:"impact",type:"MICROSERVICE"})}function m(e){return _.reduce(e,function(e,t){var c=t.name,r=t.args,n=_.get(r,"length")?r.map(function(e){return"".concat(c,":").concat(e)}):[c];return e.concat(n)},[])}}}angular.module("c8y.impact").provider(o,e)}();