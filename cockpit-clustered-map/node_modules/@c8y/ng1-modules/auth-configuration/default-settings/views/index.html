<div ng-controller="passwordCtrl" class="row">
  <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">
    <form class="card" name="passwordValidForm" ng-submit="update(passwordValidForm)" novalidate>
      <div class="card-header">
        <h4 class="card-title" translate>Login settings</h4>
      </div>
      <hr />
      <div class="card-block">
        <div class="row">
          <div class="col-sm-6">
            <div class="form-group">
              <label>
                {{ 'Preferred login mode' | translate }}:
                <a
                  href=""
                  popover-trigger="'focus'"
                  popover-append-to-body="true"
                  popover-placement="right"
                  uib-popover="{{
                    'Main difference is the storage of the authentication information. With Basic Auth, it is saved in a session storage and with OAuth Internal in a HttpOnly cookie. OAuth Internal grant is recommended as the authentication information is not accessible via JavaScript.'
                      | translate
                  }}"
                >
                  <i c8y-icon="question-circle-o"></i>
                </a>
              </label>
              <div class="c8y-select-wrapper">
                <select
                  ng-model="loginModeType"
                  class="form-control"
                  ng-change="onLoginModeChange()"
                >
                  <option value="BASIC" translate>Basic Auth</option>
                  <option value="OAUTH2_INTERNAL" translate>OAuth Internal</option>
                  <option ng-disabled="noOAuth" value="SSO_REDIRECT" translate
                    >Single sign-on redirect</option
                  >
                </select>
                <span></span>
              </div>
              <label class="c8y-checkbox" ng-class="{disabled: loginModeType !== 'OAUTH2_INTERNAL'}">
                <input
                  type="checkbox"
                  ng-model="enforceLoginMode"
                  ng-disabled="loginModeType !== 'OAUTH2_INTERNAL'"
                  ng-change="onLoginModeChange()"
                />
                <span></span>
                <span  translate>Enforce OAuth Internal</span>
                <a
                  href=""
                  popover-trigger="'focus'"
                  popover-append-to-body="true"
                  popover-placement="right"
                  uib-popover="{{
                    'If OAuth Internal is enforced, Basic Auth cannot be used to log in to applications anymore. Older applications might fail to display the login correctly and need to be updated.'
                      | translate
                  }}"
                >
                  <i c8y-icon="question-circle-o"></i>
                </a>
              </label>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-6">
            <div class="form-group">
              <label>{{ 'Limit password validity for`time-frame`' | translate }}:</label>
              <div class="input-group">
                <input
                  type="text"
                  class="form-control text-right"
                  maxlength="6"
                  ng-model="limit_validity.value"
                  ng-change="validateDays(limit_validity.value)"
                  ng-disabled="validityLimitEnforced"
                />
                <span class="input-group-addon" translate>days</span>
              </div>
              <p class="help-block">{{ 'default 0 = unlimited validity' | translate }}</p>
            </div>
          </div>
        </div>
        <label class="c8y-checkbox">
          <input
            type="checkbox"
            ng-model="strength_validity.value"
            ng-checked="system_enforce_strength.value || strength_validity.value"
            ng-disabled="system_enforce_strength.value"
          />
          <span></span>
          <translate>Enforce that all passwords are "strong" (green)</translate>
        </label>
      </div>

      <div class="card-footer">
        <button
          title="{{ 'Save' | translate }}"
          type="submit"
          class="btn btn-primary"
          ng-disabled="passwordValidForm.$invalid || passwordValidForm.$pristine"
          translate
        >
          Save
        </button>
      </div>
    </form>
  </div>
  <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">
    <c8y-tfa-settings login-mode="savedloginModeType"></c8y-tfa-settings>
  </div>
</div>