"use strict";function asyncGeneratorStep(e,n,t,r,a,i,c){try{var o=e[i](c),s=o.value}catch(e){return void t(e)}o.done?n(s):Promise.resolve(s).then(r,a)}function _asyncToGenerator(o){return function(){var e=this,c=arguments;return new Promise(function(n,t){var r=o.apply(e,c);function a(e){asyncGeneratorStep(r,n,t,a,i,"next",e)}function i(e){asyncGeneratorStep(r,n,t,a,i,"throw",e)}a(void 0)})}}function _objectSpread(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?Object(arguments[e]):{},r=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.forEach(function(e){_defineProperty(n,e,t[e])})}return n}function _defineProperty(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}!function(){e.$inject=["c8yDeviceTypeProtocolBaseProvider","gettext"];var t="c8ySNMPDevice";function e(e,P){n.$inject=["c8yDeviceDatabase","c8yDeviceControl","c8yApplication","gettextCatalog","c8yDevices","c8yBase","c8yUser"];var S={label:P("SNMP"),fieldbusType:"snmp",serviceName:t};return e.getDeviceTypeProtocolProvider(S,n);function n(e,s,n,t,u,l,a){var r={name:"snmp-mib-parser"},i=_objectSpread({},S,{options:!1,discreteOutputs:!1,discreteInputs:!1,holdingRegisters:{sectionTitle:P("Components"),noRegistersDefinedMessage:P("No components defined."),elementTypeLabel:P("Component"),newRegisterModalTitle:P("New component"),editRegisterModalTitle:P('Edit component: "{{name}}"'),addRegisterButtonLabel:P("Add component"),validation:{invalidName:P("Name must be unique among components.")},description:!0,oid:!0,functionalities:{raiseAlarm:!0,sendMeasurement:!0,sendEvent:!0}},deviceFragments:["c8y_SNMPDevice","c8y_SNMPGateway"],deviceConfiguration:{fragment:"c8y_SNMPGateway",icon:"cogs"}}),c=l.createEnum([{value:0,label:P("Version 1"),name:"VERSION_1"},{value:1,label:P("Version 2c"),name:"VERSION_2C"},{value:3,name:"VERSION_3",label:P("Version 3")}]),o=l.createEnum([{value:1,name:"NOAUTH_NOPRIV",label:P("NOAUTH_NOPRIV")},{value:2,name:"AUTH_NOPRIV",label:P("AUTH_NOPRIV")},{value:3,name:"AUTH_PRIV",label:P("AUTH_PRIV")}]),p=l.createEnum([{value:1,name:"MD5",label:P("MD5")},{value:2,name:"SHA",label:P("SHA")}]);return{registerFeaturesManifest:function(){e.registerFeaturesManifest(d().then(function(e){return e&&i}))},isAvailable:d,create:function(e,n){return v.apply(this,arguments)},update:function(e,n){return m.apply(this,arguments)},isSNMP:function(e){return!!(e||{}).c8y_SNMPDevice},snmpVersions:c,snmpAuthPrivProtocols:l.createEnum([{value:1,name:"DES",label:P("DES")},{value:2,name:"AES128",label:P("AES128")},{value:3,name:"AES192",label:P("AES192")},{value:4,name:"AES256",label:P("AES256")}]),snmpAuthProtocols:p,snmpSecurityLevels:o};function d(){return e.isFeatureFieldbus4Available()&&n.isAvailable(r)}function v(){return(v=_asyncToGenerator(regeneratorRuntime.mark(function e(a,i){var c,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y(a,i);case 2:return c=e.sent,e.t0=l,e.next=6,u.createConfirm(c);case 6:return e.t1=e.sent,o=e.t0.getResData.call(e.t0,e.t1),e.next=10,u.addChildDevice(a,o);case 10:return o.owner=a.owner,e.next=13,u.save(o);case 13:return e.abrupt("return",s.create((n=a,t=i.deviceType,r=o,{deviceId:n.id,description:'Added new child device to "'.concat(n.name,'" (ID: ').concat(n.id,")."),c8y_SNMPDevice:b(t,r)})));case 14:case"end":return e.stop()}var n,t,r},e)}))).apply(this,arguments)}function m(){return(m=_asyncToGenerator(regeneratorRuntime.mark(function e(a,i){var c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y(a,i);case 2:return(c=e.sent).id=i.id,c.owner=a.owner,e.next=7,u.update(c);case 7:return e.abrupt("return",s.create((n=a,t=i.deviceType,r=c,{deviceId:n.id,description:'Updated child device of "'.concat(n.name,'" (ID: ').concat(n.id,")."),c8y_SNMPDevice:b(t,r)})));case 8:case"end":return e.stop()}var n,t,r},e)}))).apply(this,arguments)}function y(e,n){return f.apply(this,arguments)}function f(){return(f=_asyncToGenerator(regeneratorRuntime.mark(function e(n,t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.current();case 2:return r=e.sent,e.abrupt("return",{name:t.name,type:t.deviceType.name,c8y_SNMPDevice:{ipAddress:t.ipAddress,port:t.port,version:t.version,auth:(n=t.auth,_.pick(n,["username","privPassword","authPassword","authProtocol","privProtocol","securityLevel","engineId"])),type:"/inventory/managedObjects/".concat(t.deviceType.id)},owner:r.id});case 4:case"end":return e.stop()}var n},e)}))).apply(this,arguments)}function b(e,n){return{id:n.id,name:n.name,ipAddress:n.c8y_SNMPDevice.ipAddress,port:n.c8y_SNMPDevice.port,version:n.c8y_SNMPDevice.version,auth:n.c8y_SNMPDevice.auth,type:"/inventory/managedObjects/".concat(e.id)}}}}angular.module("c8y.snmp").provider(t,e)}();