"use strict";!function(){function e(t,e,n,i,l,c){var o,s=this,r={},d={},u=null,f={open:!1},a={text:""};function h(e){r={},d={},_.forEach(e,function(e){r[e.id]=!0,d[e.id]=!0})}function g(e){return d[e.id]}function p(e){d[e.id]=!0}function A(){return e("filter")(o,a.text)}function S(e){d[e.id]=!1}s.isSelected=g,s.selectAllVisible=function(){_.forEach(A(),p)},s.select=p,s.deselectAllVisible=function(){_.forEach(A(),S)},s.deselect=S,s.toggle=function(e){d[e.id]=!d[e.id]},s.areAllVisibleSelected=function(){var e=A();return!!e&&_.filter(e,g).length===e.length},s.getSelectedStatusText=function(){var e=_.filter(r,_.identity).length;return e===u?c.getString("All selected"):0===e?c.getString("None selected"):c.getPlural(e,"1 selected","{{$count}} selected",{})},s.apply=function(){t.onSelectionConfirmed&&t.onSelectionConfirmed({selection:_.filter(o,g)}),f.open=!1},s.filterCfg=a,s.dropdownStatus=f,t.$watch("parentMo()",function(e){s.parentMoId=e.id||e,l.detailCached(s.parentMoId).then(i.getResData).then(function(e){s.childAssets=_.map(e.childAssets.references,"managedObject"),o=s.childAssets,u=e.childAssets.references.length})}),t.$watch("selectedChildAssets()",h),t.$watch("ctrl.dropdownStatus.open",function(e){e&&h(t.selectedChildAssets()),n(function(){s.dropdownOpeningFinished=e})})}e.$inject=["$scope","$filter","$timeout","c8yBase","c8yInventory","gettextCatalog"],angular.module("c8y.smartRules").controller("c8yChildAssetsSelectorCtrl",e)}();