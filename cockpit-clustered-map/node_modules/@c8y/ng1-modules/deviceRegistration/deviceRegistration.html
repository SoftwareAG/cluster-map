<div>
  <c8y-ui-action-bar-set>
    <li
      class="navbar-form hidden-xs"
      action-bar-position="left"
      ng-show="vm.newDeviceRequests.length > 0"
    >
      <c8y-list-display-control
        list-length="vm.newDeviceRequests.length"
        on-list-class-change="vm.listClass = listClass"
      >
      </c8y-list-display-control>
    </li>

    <li ng-show="vm.canAcceptAll()">
      <button
        title="{{ 'Accept all' | translate }}"
        type="button"
        class="btn btn-link"
        ng-click="vm.acceptAll()"
        ng-disabled="vm.limitStatus.isReached"
      >
        <i c8y-icon="check"></i> {{ 'Accept all' | translate }}
      </button>
    </li>

    <c8y-refresh-btn></c8y-refresh-btn>
  </c8y-ui-action-bar-set>

  <!-- empty state -->
  <div ng-if="vm.newDeviceRequests.length === 0">
    <div
      ng-if="!vm.limitStatus.isReached"
      class="c8y-empty-state text-center"
      style="margin-top: 40px;"
    >
      <h1 class="c8y-icon c8y-icon-device-connect c8y-icon-duocolor"></h1>
      <h3 translate>No pending registrations to display.</h3>
      <p translate>Use the wizard to register a new device.</p>
      <c8y-if-allowed any-role="['ROLE_DEVICE_CONTROL_ADMIN']">
        <button
          title="{{ 'Register device' | translate }}"
          class="btn btn-primary"
          ng-click="vm.addWithWizard()"
        >
          <i c8y-icon="c8y-device-connect"></i>
          <translate>Register device</translate>
        </button>
      </c8y-if-allowed>
    </div>
    <div
      ng-if="vm.limitStatus.isReached"
      class="c8y-empty-state text-center"
      style="margin-top: 40px;"
    >
      <h1 class="c8y-icon c8y-icon-device-connect c8y-icon-duocolor"></h1>
      <h3 translate>
        You reached the limit of {{ vm.limitStatus.limit }} devices. No more devices can be
        registered.
      </h3>
      <p translate>Please contact your platform administrator.</p>
    </div>
  </div>
  <!-- /.empty state -->

  <div class="card-group" ng-class="vm.listClass">
    <div
      c8y-if-allowed
      any-role="['ROLE_DEVICE_CONTROL_ADMIN']"
      ng-if="vm.newDeviceRequests.length > 0 && !vm.limitStatus.isReached"
      class="col-xs-12 col-sm-6 col-md-4 col-lg-3"
    >
      <a
        title="{{ 'Register device' | translate }}"
        href=""
        class="card add-card"
        ng-click="vm.addWithWizard()"
      >
        <i c8y-icon="c8y-device-connect c8y-icon-duocolor"></i><br />
        <translate>Register device</translate>
      </a>
    </div>

    <div
      ng-if="vm.newDeviceRequests.length > 0 && vm.limitStatus.isReached"
      class="col-xs-12 col-sm-6 col-md-4 col-lg-3"
    >
      <p class="card add-card" translate>
        You reached the limit of {{ vm.limitStatus.limit }} devices.<br />
        No more devices can be registered.<br />
        Please contact your platform administrator.
      </p>
    </div>

    <div class="col-xs-12 col-sm-6 col-md-4 col-lg-3" ng-repeat="d in vm.newDeviceRequests">
      <div class="card">
        <div class="card-header separator">
          <div class="card-icon">
            <i c8y-icon="{{ vm.statusIcon(d) }}" ng-class="vm.statusClass(d)"></i>
          </div>
          <p class="card-title text-truncate">{{ d.id }}</p>
        </div>
        <div class="card-block text-center">
          <label translate>Status</label>
          <p>{{ d.status | humanize | translate }}</p>
        </div>
        <div class="card-actions-group">
          <c8y-if-allowed any-role="['ROLE_DEVICE_CONTROL_ADMIN']">
            <button
              title="{{ 'Remove' | translate }}"
              class="btn btn-danger btn-xs"
              ng-click="vm.onClickCancel(d)"
            >
              {{ 'Remove' | translate }}
            </button>
            <button
              title="{{ 'Accept' | translate }}"
              class="btn btn-primary btn-xs"
              ng-click="vm.onClickAccept(d)"
              ng-show="d.status===vm.newDeviceRequestsStatus.PENDING_ACCEPTANCE"
              ng-disabled="vm.limitStatus.isReached"
            >
              {{ 'Accept' | translate }}
            </button>
          </c8y-if-allowed>
        </div>
        <div class="card-footer separator text-center text-muted">
          <span ng-if="vm.isTopTenant">
            <span ng-if="d.creationTime && d.owner" translate>
              <strong>Created on</strong> {{ d.creationTime | absoluteDate }} <strong>by</strong> {{ d.owner }} <strong>in</strong> {{ d.tenantId }}
            </span>
            <span ng-if="!d.creationTime || !d.owner" translate>
              <strong>Created in</strong> {{ d.tenantId }}
            </span>
          </span>
          <span ng-if="!vm.isTopTenant" translate>
            <strong>Created on</strong> {{ d.creationTime | absoluteDate }} <strong>by</strong> {{ d.owner }}
          </span>
        </div>
      </div>
    </div>
  </div>

  <c8y-load-more></c8y-load-more>
</div>
