<c8y-breadcrumbs-set>
  <c8y-breadcrumbs-item
    path="#tenants"
    label="{{ 'Tenants' | translate }}"
    icon="c8y-sub-tenants"
  ></c8y-breadcrumbs-item>
</c8y-breadcrumbs-set>

<div class="row">
  <c8y-subscribed-applications
    dissociate="dissociate"
    associated-applications="associatedApplications"
  >
  </c8y-subscribed-applications>

  <div class="col-md-6">
    <div class="card">
      <div class="card-header">
        <h4 class="card-title">
          {{ 'Available applications' | translate }}
          <a href uib-popover-template="popoverTemplateUrl" popover-placement="right">
            <i c8y-icon="question-circle-o"></i>
          </a>
        </h4>
      </div>
      <hr />
      <div class="card-block">
        <div class="form-inline">
          <div title="{{ 'Filter tenants' | translate }}" class="input-group input-group-search">
            <input
              type="search"
              class="form-control"
              ng-model="filter.text.$"
              placeholder="{{ 'Filterâ€¦' | translate }}"
            />
            <span class="input-group-addon">
              <i c8y-icon="search" ng-show="filter.text.$.length === 0 || !filter.text.$ "></i>
              <i
                c8y-icon="times"
                class="text-muted"
                ng-show="filter.text.$.length > 0"
                ng-click="filter.text.$ = ''"
              ></i>
            </span>
          </div>
          <label class="control-label">{{ 'Owner' | translate }}:</label>
          <div class="c8y-select-wrapper">
            <select
              ng-options="owner.value as owner.label for owner in owners | orderBy:'label'"
              ng-model="filter.owner"
              class="form-control"
            ></select>
            <span></span>
          </div>
        </div>
      </div>
      <ul class="list-group card-inner-scroll" style="max-height:calc(100vh - 294px);">
        <li
          class="list-group-item flex-row collapsible"
          ng-class="{'expanded': isOpen(a)}"
          ng-repeat="a in applications|filter:filterOwner|filter:filter.text"
        >
          <div class="list-item-body flex-row">
            <c8y-app-icon app="::a" style="font-size: 30px;"></c8y-app-icon>
            <p title="{{ a | humanizeAppName }}" style="margin-left: 10px;">{{ a | humanizeAppName }}</p>

            <button
              title="{{ 'subscribe' | translate }}"
              ng-click="associate(a)"
              style="margin-right: 30px;"
              class="btn btn-primary btn-xs showOnHover flex-item-right"
              translate
            >
              subscribe
            </button>
          </div>
          <div class="list-item-actions">
            <button
              type="button"
              title="{{ 'Expand' | translate }}"
              class="collapse-btn"
              ng-click="openItem(a)"
            >
              <i c8y-icon="chevron-down"></i>
            </button>
          </div>
          <div uib-collapse="!isOpen(a)">
            <p>
              <label class="small">{{ 'Availability' | translate }}:</label> {{ a.availability }}
            </p>
            <p>
              <label class="small">{{ 'Type' | translate }}:</label> {{ a.type }}
            </p>
            <p>
              <label class="small">{{ 'Owner' | translate }}:</label> {{ a.owner.tenant.id }}
            </p>
          </div>
        </li>
      </ul>
    </div>
  </div>
</div>
